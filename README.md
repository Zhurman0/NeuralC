it was written in a total of 3 hours, the best hours of interpreting mathematical formulas into code

there is an error in calculating error gradients, but I don't understand where

I will be glad for any hints
